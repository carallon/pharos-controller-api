openapi: 3.0.3
info:
  version: "9"
  title: Pharos Control API
servers:
  - url: "http://localhost/api"
security:
  - bearer: []
  - cookie: []
tags:
  - name: Authentication
  - name: Beacon
  - name: Channel / Park
  - name: Cloud
  - name: Command
    description: (Designer only)
  - name: Config
  - name: Controller
  - name: Content Targets
    description: (Designer only)
  - name: DALI
    description: (Designer only)
  - name: DALI Interface
    description: (Designer only)
  - name: Factory Reset
  - name: Fixtures
    description: (Designer only)
  - name: Group
    description: (Designer only)
  - name: Hardware Reset
  - name: Input
  - name: Log
  - name: Lua Variable
    description: (Designer only)
  - name: Mode Switch
    description: (Expert only)
  - name: Output
  - name: Override
  - name: Project
  - name: Project File
    description: (Designer only)
  - name: Protocol
  - name: RDM Discovery
    description: (Designer only)
  - name: RDM Get
    description: (Designer only)
  - name: RDM Set
    description: (Designer only)
  - name: Remote Device
    description: (Designer only)
  - name: Replication
    description: (Designer only)
  - name: Scene
  - name: Schedule
    description: (Expert only)
  - name: Space
    description: (Expert only)
  - name: System
  - name: Tag Set
    description: (Expert only)
  - name: Temperature
    description: (Designer only)
  - name: Text Slots
    description: (Designer only)
  - name: Time
  - name: Timeline
    description: (Designer only)
  - name: Trigger
    description: (Designer only)
  - name: User
  - name: User Groups
  - name: (Internal)
    description: Excluded from user documentation
paths:
  /authenticate:
    post:
      tags:
        - Authentication
      servers:
        - url: "http://localhost"
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/Login"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/Login"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BearerToken"
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
  /api_version:
    get:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: integer
                    example: 8
  /time:
    get:
      tags:
        - Time
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CurrentTime"
  /system:
    get:
      tags:
        - System
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/System"
  /project:
    get:
      tags:
        - Project
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Project"
  /project/file:
    get:
      tags:
        - Project File
      responses:
        '200':
          description: OK
          content:
            application/vnd.pharos:
              schema:
                type: string
                format: binary
    post:
      tags:
        - Project File
      requestBody:
        required: true
        content:
          application/vnd.pharos:
            schema:
              type: string
              format: binary
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
        '411':
          description: Length Required
  /project/reload_dropped:
    post:
      tags:
        - (Internal)
      responses:
        '204':
          description: OK
        '401':
          description: Unauthorized
        '409':
          description: Conflict
  /firmware:
    post:
      tags:
        - (Internal)
      requestBody:
        required: true
        content:
          application/vnd.pharos:
            schema:
              type: string
              format: binary
      responses:
        '204':
          description: OK
        '411':
          description: Length Required
  /timeline:
    get:
      tags:
        - Timeline
      parameters:
        - in: query
          name: num
          required: false
          schema:
            $ref: "#/components/schemas/IdList"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  timelines:
                    type: array
                    items:
                      $ref: "#/components/schemas/Timeline"
    post:
      tags:
        - Timeline
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlTimeline"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /scene:
    get:
      tags:
        - Scene
      parameters:
        - in: query
          name: num
          required: false
          schema:
            $ref: "#/components/schemas/IdList"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  scenes:
                    type: array
                    items:
                      $ref: "#/components/schemas/StaticScene"
    post:
      tags:
        - Scene
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlScene"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /playlist:
    get:
      tags:
        - (Internal)
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  playlists:
                    type: array
                    items:
                      $ref: "#/components/schemas/Playlist"
  /group:
    get:
      tags:
        - Group
      parameters:
        - in: query
          name: num
          required: false
          schema:
            $ref: "#/components/schemas/IdList"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      $ref: "#/components/schemas/Group"
    post:
      tags:
        - Group
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlGroup"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /content_target:
    get:
      tags:
        - Content Targets
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  content_targets:
                    type: array
                    items:
                      $ref: "#/components/schemas/ContentTarget"
    post:
      tags:
        - Content Targets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlContentTarget"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /remote_device:
    get:
      tags:
        - Remote Device
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  remote_devices:
                    type: array
                    items:
                      $ref: "#/components/schemas/RemoteDevice"
  /controller:
    get:
      tags:
        - Controller
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  controllers:
                    type: array
                    items:
                      $ref: "#/components/schemas/Controller"
  /text_slot:
    get:
      tags:
        - Text Slots
      parameters:
        - in: query
          name: names
          required: false
          schema:
            $ref: "#/components/schemas/NameList"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  text_slots:
                    type: array
                    items:
                      $ref: "#/components/schemas/TextSlot"
    put:
      tags:
        - Text Slots
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TextSlot"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /temperature:
    get:
      tags:
        - Temperature
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Temperature"
  /fan_speed:
    get:
      tags:
        - (Internal)
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FanSpeed"
  /log:
    get:
      tags:
        - Log
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  log:
                    type: string
    delete:
      tags:
        - Log
      responses:
        '204':
          description: OK
  /protocol:
    get:
      tags:
        - Protocol
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  outputs:
                    type: array
                    items:
                      $ref: "#/components/schemas/OutputProtocol"
  /output:
    get:
      tags:
        - Output
      parameters:
        - in: query
          name: universe
          schema:
            $ref: "#/components/schemas/UniverseId"
          required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Output"
    post:
      tags:
        - Output
      requestBody:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ControlOutput"
            application/x-www-form-urlencoded:
              schema:
                $ref: "#/components/schemas/ControlOutput"
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/ControlOutput"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /input:
    get:
      tags:
        - Input
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Input"
  /trigger:
    get:
      tags:
        - Trigger
      parameters:
        - in: query
          name: type
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  triggers:
                    type: array
                    items:
                      $ref: "#/components/schemas/Trigger"
    post:
      tags:
        - Trigger
      requestBody:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FireTrigger"
            application/x-www-form-urlencoded:
              schema:
                $ref: "#/components/schemas/FireTrigger"
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/FireTrigger"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /dali_interface:
    get:
      tags:
        - DALI Interface
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  dali_interface:
                    type: array
                    items:
                      $ref: "#/components/schemas/DaliInterface"
  /dali:
    get:
      tags:
        - DALI
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Dali"
    post:
      tags:
        - DALI
      requestBody:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ControlDali"
            application/x-www-form-urlencoded:
              schema:
                $ref: "#/components/schemas/ControlDali"
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/ControlDali"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /lua:
    get:
      tags:
        - Lua Variable
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
  /replication:
    get:
      tags:
        - Replication
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  replication:
                    oneOf:
                      - type: object
                        properties:
                          name:
                            type: string
                          unique_id:
                            type: string
                      - type: boolean
  /io_modules:
    get:
      tags:
        - (Internal)
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  instances:
                    type: array
                    items:
                      $ref: "#/components/schemas/IoModule"
  /config:
    get:
      tags:
        - Config
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Config"
    post:
      tags:
        - Config
      requestBody:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Config"
            application/x-www-form-urlencoded:
              schema:
                $ref: "#/components/schemas/Config"
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/Config"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /cloud:
    get:
      tags:
        - Cloud
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  state:
                    type: object
                    properties:
                      connecting:
                        type: boolean
                      connected:
                        type: boolean
    post:
      tags:
        - Cloud
      requestBody:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ControlCloud"
            application/x-www-form-urlencoded:
              schema:
                $ref: "#/components/schemas/ControlCloud"
            multipart/form-data:
              schema:
                $ref: "#/components/schemas/ControlCloud"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '204':
          description: OK
        '400':
          description: Bad Request
        '501':
          description: Not Implemented
  /channel:
    post:
      tags:
        - Channel / Park
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ParkChannel"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/ParkChannel"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/ParkChannel"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
    delete:
      tags:
        - Channel / Park
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ParkChannel"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/ParkChannel"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/ParkChannel"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /override:
    put:
      tags:
        - Override
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetOverride"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/SetOverride"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/SetOverride"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
        '500':
          description: Internal Server Error
        '503':
          description: Service Unavailable
    delete:
      tags:
        - Override
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ClearOverride"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/ClearOverride"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/ClearOverride"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /cmdline:
    post:
      tags:
        - Command
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RunCommand"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/RunCommand"
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/RunCommand"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
        '501':
          description: Not Implemented
  /beacon:
    post:
      tags:
        - Beacon
      responses:
        '204':
          description: OK
  /format:
    post:
      tags:
        - (Internal)
      responses:
        '204':
          description: OK
        '500':
          description: Internal Server Error
  /reset:
    post:
      tags:
        - Hardware Reset
      responses:
        '204':
          description: OK
  /factory_reset:
    post:
      tags:
        - Factory Reset
      responses:
        '204':
          description: OK
  /space:
    get:
      tags:
        - Space
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  spaces:
                    type: array
                    items:
                      $ref: "#/components/schemas/Space"
    post:
      tags:
        - Space
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlSpace"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /rdm/discovery:
    get:
      tags:
        - RDM Discovery
      parameters:
        - in: query
          name: universe
          schema:
            $ref: "#/components/schemas/UniverseId"
          required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  devices:
                    type: array
                    items:
                      $ref: "#/components/schemas/RdmDeviceInfo"
                  token:
                    $ref: "#/components/schemas/Token"
    post:
      tags:
        - RDM Discovery
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartRdmDiscovery"
      responses:
        '202':
          description: Accepted
        '400':
          description: Bad Request
    put:
      tags:
        - RDM Discovery
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartRdmDiscovery"
      responses:
        '202':
          description: Accepted
        '400':
          description: Bad Request
  /rdm/discovery/unpatched:
    get:
      tags:
        - RDM Discovery
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: array
                  items:
                    $ref: "#/components/schemas/RdmDeviceInfo"
  /rdm/get:
    post:
      tags:
        - RDM Get
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartRdmOperation"
      responses:
        '202':
          description: Accepted
        '400':
          description: Bad Request
  /rdm/get_descriptions:
    post:
      tags:
        - RDM Get
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartRdmGetDescriptionsOperation"
      responses:
        '202':
          description: Accepted
        '400':
          description: Bad Request
  /rdm/set:
    post:
      tags:
        - RDM Set
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartRdmOperation"
      responses:
        '202':
          description: Accepted
        '400':
          description: Bad Request
  /mode:
    get:
      tags:
        - Mode Switch
      summary: Get current mode dial position
      operationId: getWheelMode
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  mode:
                    type: string
                    enum: [Run, Dmx1, Dmx2, Dali, All, Off, PG1, PG2, PG3, PG4]
  /setup:
    post:
      tags:
        - (Internal)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
    put:
      tags:
        - (Internal)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
    delete:
      tags:
        - (Internal)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_password:
                  $ref: '#/components/schemas/Password'
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
  /user:
    get:
      tags:
        - User
      summary: Get the username and access level of user whose username matches
               the username param or currently authenticated user if none given.
               404 error if a non-existant username is given. Non-admin users may
               only request their own info.
      parameters:
        - name: username
          in: query
          required: false
          schema:
           $ref: '#/components/schemas/Username'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
        '401':
          description: Unauthorised
        '404':
          description: Not Found
    post:
      tags:
        - User
      summary: Create user with access level 'control' and set password
      description: >
        Currently logged in user must supply their password for action to proceed.
        Does not require session_password if a password has not yet been set on
        the controller.
      operationId: createUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '201':
          description: User created
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    $ref: '#/components/schemas/Token'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
    put:
      tags:
        - User
      summary: Update a user account with a new password and/or access groups
      description: >
        Currently logged in user must supply their password for action to proceed
      operationId: updateUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    $ref: '#/components/schemas/Token'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
    delete:
      tags:
        - User
      summary: Delete user
      description: >
        Currently logged in user must supply their password for action to proceed
      operationId: deleteUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - session_password
                - username
              properties:
                session_password:
                  $ref: '#/components/schemas/Password'
                username:
                  $ref: '#/components/schemas/Username'
      responses:
        '201':
          description: User deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    $ref: '#/components/schemas/Token'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
  /user_groups:
    get:
      tags:
        - User Groups
      summary: List access permissions
      operationId: getUserGroups
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_groups:
                    $ref: '#/components/schemas/AccessGroups'
                  token:
                    $ref: '#/components/schemas/Token'
  /guest_groups:
    get:
      tags:
        - User Groups
      summary: List guest permissions
      operationId: getGuestGroups
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  guest_groups:
                    $ref: '#/components/schemas/AccessGroups'
                  token:
                    $ref: '#/components/schemas/Token'
    post:
      tags:
        - User Groups
      summary: Change guest permissions
      operationId: setGuestGroups
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_password:
                  $ref: '#/components/schemas/Password'
                access:
                  $ref: '#/components/schemas/AccessGroups'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    $ref: '#/components/schemas/Token'
  /tag_set:
    get:
      tags:
        - Tag Set
      summary: List tag sets
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  tag_sets:
                    type: array
                    items:
                      $ref: "#/components/schemas/TagSet"
    post:
      tags:
        - Tag Set
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ControlTagSet"
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /schedule:
    get:
      tags:
        - Schedule
      summary: Get Schedule Enabled/Suppressed
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  enable:
                    type: boolean
    put:
      tags:
        - Schedule
      summary: Set Schedule Enabled/Suppressed
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enable:
                  type: boolean
      responses:
        '204':
          description: OK
        '400':
          description: Bad Request
  /ping:
    post:
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Ping"
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
        '500':
          description: Internal Server Error
  /fixtures:
    get:
      tags:
        - Fixtures
      summary: Get an overview of fixtures used in the current project including their statuses
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FixtureStatusOverview'
        '400':
          description: Bad Request
  /fixtures/{fixtureNumber}:
    get:
      tags:
        - Fixtures
      summary: Get detailed information for a single fixture including its status
      parameters:
        - name: fixtureNumber
          in: path
          description: Fixture user number
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FixtureStatusDetail'
        '400':
          description: Bad Request
  /fixtures/{fixtureNumber}/devices:
    get:
      tags:
        - Fixtures
      summary: Get an overview of a fixture's physical devices including their statuses
      parameters:
        - name: fixtureNumber
          in: path
          description: Fixture user number
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DeviceStatus'
        '400':
          description: Bad Request
  /fixtures/{fixtureNumber}/devices/{deviceId}:
    get:
      tags:
        - Fixtures
      summary: Get a single physical device for a fixture including its status
      parameters:
        - name: fixtureNumber
          in: path
          description: Fixture user number
          required: true
          schema:
            type: integer
        - name: deviceId
          in: path
          description: RDM device UID
          required: true
          schema:
            $ref: "#/components/schemas/RdmDeviceUid"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceStatus'
        '400':
          description: Bad Request
        '404':
          description: Not Found
components:
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
    cookie:
      type: apiKey
      in: cookie
      name: session
  schemas:
    Date:
      type: string
      pattern: /^\d{2} \d{2} \d{4} \d{2}\.\d{2}(\.\d{2})?$/
    CurrentTime:
      type: object
      properties:
        datetime:
          $ref: "#/components/schemas/Date"
        local_time:
          type: integer
          format: int64
        uptime:
          type: integer
          format: int64
    Project:
      type: object
      properties:
        name:
          type: string
        author:
          type: string
        filename:
          type: string
        uniqueId:
          type: string
        upload_date:
          $ref: "#/components/schemas/Date"
    System:
      type: object
      properties:
        hardware_type:
          type: string
          enum: [Unknown, LPC, LPC X, TPC, VLC, VLC+, TPS, SOLO, MSC, MSC X, MTPC, Atlas, Atlas Pro, M-TS]
        channel_capacity:
          type: integer
        serial_number:
          type: string
        memory_total:
          type: string
          pattern: /\d+ KB/
        memory_used:
          type: string
          pattern: /\d+ KB/
        memory_available:
          type: string
          pattern: /\d+ KB/
        storage_size:
          type: string
          pattern: /(\d+ MB)|(Not present)/
        bootloader_version:
          type: string
        firmware_version:
          type: string
        reset_reason:
          type: string
        last_boot_time:
          $ref: "#/components/schemas/Date"
        ip_address:
          type: string
        subnet_mask:
          type: string
        default_gateway:
          type: string
    Timeline:
      type: object
      properties:
        name:
          type: string
        length:
          type: integer
        group:
          type: string
        source_bus:
          type: string
          enum: [internal, real_time, timecode_1, timecode_2, timecode_3, timecode_4, timecode_5, timecode_6, audio_1, audio_2, audio_3, audio_4]
        timecode_format:
          type: string
        audio_band:
          type: integer
        audio_channel:
          type: string
        audio_peak:
          type: boolean
        time_offset:
          type: integer
        priority:
          type: string
          enum: [high, above_normal, normal, below_normal, low]
      additionalProperties: true
    StaticScene:
      type: object
      properties:
        name:
          type: string
        num:
          type: integer
        state:
          type: string
          enum: [started, released, none]
        onstage:
          type: boolean
        group:
          type: string
      additionalProperties: true
    Playlist:
      type: object
      properties:
        name:
          type: string
        position:
          type: integer
        state:
          type: string
          enum: [running, holding_at_end, released, none]
        onstage:
          type: boolean
    Group:
      type: object
      properties:
        name:
          type: string
        num:
          type: integer
        level:
          type: integer
    ContentTarget:
      type: object
      properties:
        name:
          type: string
        level:
          type: integer
    RemoteDevice:
      type: object
      properties:
        num:
          type: integer
        type:
          type: string
        name:
          type: string
        name_with_type:
          type: string
        serial:
          type: array
          items:
            type: string
        online:
          type: boolean
        outputs:
          type: array
          items:
            type: object
            properties:
              output:
                type: integer
              state:
                type: boolean
        inputs:
          $ref: "#/components/schemas/GPIO"
    Controller:
      type: object
      properties:
        num:
          type: integer
        type:
          type: string
          enum: [Unknown, LPC, LPC X, TPC, VLC, VLC+, TPS, SOLO, MSC, MSC X, MTPC, Atlas, Atlas Pro, M-TS]
        serial:
          type: string
        ip_address:
          type: string
        online:
          type: boolean
        is_network_primary:
          type: boolean
    TextSlot:
      type: object
      properties:
        name:
          type: string
        value:
          type: string
    Temperature:
      type: object
      properties:
        temp:
          type: object
          properties:
            sys_temp:
              type: integer
            core_temp:
              type: integer
            ambient_temp:
              type: integer
            gpu_temp:
              type: integer
            cc_temp:
              type: integer
    FanSpeed:
      type: object
      properties:
        fan_speed:
          type: object
          properties:
            fan_1:
              type: integer
            fan_2:
              type: integer
    OutputProtocol:
      type: object
      properties:
        type:
          type: string
        name:
          type: string
        disabled:
          type: boolean
        dmx_proxy:
          type: object
          properties:
            name:
              type: string
            ip_address:
              type: string
        universes:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              key:
                $ref: "#/components/schemas/UniverseKey"
    Output:
      type: object
      properties:
        channels:
          type: array
          items:
            type: string
            pattern: '^((\+|!)?\d+)| $'
        proxied_tpc_name:
          type: string
        disabled:
          type: boolean
      additionalProperties: false
      oneOf:
        - required: [channels, disabled]
        - required: [proxied_tpc_name, disabled]
    Input:
      type: object
      properties:
        gpio:
          $ref: "#/components/schemas/GPIO"
        dmxIn:
          type: object
    GPIO:
      type: array
      items:
        type: object
        properties:
          input:
            type: integer
          type:
            type: string
            enum: [Analog, Digital, Contact Closure]
          value:
            oneOf:
              - type: integer
                minimum: 0
                maximum: 100
              - type: boolean
    Trigger:
      type: object
      properties:
        type:
          type: string
        num:
          type: integer
        name:
          type: string
        group_num:
          type: string
        trigger_text:
          type: string
        description:
          type: string
        conditions:
          type: array
          items:
            type: object
            properties:
              text:
                type: string
              icon:
                type: string
        actions:
          type: array
          items:
            type: object
            properties:
              text:
                type: string
              icon:
                type: string
    DaliInterface:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
    Dali:
      type: object
      properties:
        online:
          type: boolean
        schedule:
          type: object
          properties:
            next_function_test:
              $ref: "#/components/schemas/Date"
            next_duration_test:
              $ref: "#/components/schemas/Date"
            prev_function_test:
              $ref: "#/components/schemas/Date"
            prev_duration_test:
              $ref: "#/components/schemas/Date"
        power:
          type: object
          properties:
            dali_bus_uptime:
              type: integer
            power_failures:
              type: array
              items:
                $ref: "#/components/schemas/Date"
        errors:
          type: array
          items:
            type: object
            properties:
              address:
                type: integer
              test:
                type: string
              error:
                type: string
              fixed:
                type: boolean
        ballast_status:
          type: array
          items:
            type: object
            properties:
              address:
                type: string
              user_name:
                type: string
              status:
                type: string
              actual_level:
                type: integer
              battery_level:
                type: integer
              battery_charged:
                type: boolean
              lamp_emergency_hours:
                type: integer
              lamp_total_hours:
                type: integer
              last_status_check:
                $ref: "#/components/schemas/Date"
    IoModule:
      type: object
      properties:
        modules:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              name:
                type: string
        instances:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              module_id:
                type: integer
              name:
                type: string
              status:
                type: array
                items:
                  type: object
                  properties:
                    key:
                      type: string
                    label:
                      type: string
                    value:
                      type: string
    Config:
      type: object
      properties:
        ip:
          type: string
        subnet_mask:
          type: string
        gateway:
          type: string
        dhcp_enabled:
          type: boolean
        name_server_1:
          type: string
        name_server_2:
          type: string
        http_port:
          type: integer
        https_port:
          type: integer
        datetime:
          type: string
          format: date-time
          example: "2024-06-27T09:30"
        watchdog_enabled:
          type: boolean
        log_level:
          type: integer
        syslog_ip:
          type: string
        ntp_enabled:
          type: boolean
        ntp_ip:
          type: string
    ParkChannel:
      type: object
      properties:
        universe:
          $ref: "#/components/schemas/UniverseId"
        channels:
          $ref: "#/components/schemas/IdList"
        level:
          type: integer
    SetOverride:
      allOf:
        - type: object
          properties:
            target:
              type: string
              enum: [group, fixture]
            num:
              type: integer
        - $ref: "#/components/schemas/Override"
        - $ref: "#/components/schemas/Fade"
      required: [target, num]
    ClearOverride:
      type: object
      properties:
        target:
          type: string
          enum: [group, fixture]
        num:
          type: integer
        fade:
          type: integer
          minimum: 0
          maximum: 3600000
      required: [target, num]
    IdList:
      oneOf:
        - type: array
          items:
            oneOf:
              - type: string
                pattern: /\d+-\d+/
              - type: integer
        - type: integer
    NameList:
      oneOf:
        - type: array
          items:
            type: string
        - type: string
    UniverseId:
      oneOf:
        - type: string
          pattern: /((dmx|art-net|pathport|sacn):\d+)|(kinet:\d+:\d+)|(rio-dmx:(rio08|rio44|rio80):\d+)|(edn:(edn20|edn10):\d+:\d+)|(edn-spi:(edn20|edn10):\d+:\d+)/
        - allOf:
            - $ref: "#/components/schemas/UniverseKey"
            - type: object
              properties:
                protocol:
                  type: integer
    UniverseKey:
      type: object
      properties:
        index:
          type: integer
        remote_device_num:
          type: integer
        remote_device_type:
          type: integer
        kinet_power_supply_num:
          type: integer
        kinet_port:
          type: integer
        port:
          type: integer
      oneOf:
        - required: [index]
        - required: [remote_device_num, remote_device_type]
        - required: [kinet_power_supply_num, kinet_port]
        - required: [remote_device_num, remote_device_type, port]
    ControlTimeline:
      type: object
      properties:
        num:
          type: integer
        action:
          type: string
          enum: [start, start_release_others, release, toggle, pause, resume, set_rate, set_position]
        fade:
          type: integer
        group:
          type: string
        same_group:
          type: boolean
        rate:
          $ref: '#/components/schemas/LevelInBounded'
        position:
          $ref: '#/components/schemas/LevelInBounded'
    ControlScene:
      type: object
      properties:
        num:
          type: integer
        action:
          type: string
          enum: [start, start_release_others, release, toggle]
        fade:
          type: integer
        group:
          type: string
        same_group:
          type: boolean
    ControlGroup:
      type: object
      properties:
        num:
          type: integer
        action:
          type: string
          enum: [master_intensity]
        level:
          $ref: '#/components/schemas/LevelInBounded'
        fade:
          type: integer
        delay:
          type: integer
    ControlContentTarget:
      type: object
      properties:
        type:
          type: string
          enum: [primary, secondary, target_3, target_4, target_5, target_6, target_7, target_8]
        action:
          type: string
          enum: [master_intensity]
        level:
          $ref: '#/components/schemas/LevelInBounded'
        fade:
          type: integer
        delay:
          type: integer
    ControlOutput:
      type: object
      properties:
        protocol:
          type: string
          enum: [dmx, pathport, sacn, art-net, kinet, rio-dmx, edn, edn-spi]
        action:
          type: string
          enum: [enable, disable]
    ControlDali:
      type: object
      properties:
        interface:
          type: integer
        address:
          type: integer
        action:
          type: string
          enum: [mark_fixed, refresh]
    ControlCloud:
      type: object
      properties:
        action:
          type: string
          enum: [set_device_key, clear_device_key]
        cloud_device_key:
          type: string
    FireTrigger:
      type: object
      properties:
        var:
          type: string
        conditions:
          type: boolean
        num:
          type: integer
    RunCommand:
      type: object
      properties:
        input:
          type: string
    Login:
      type: object
      required:
        - username
        - password
      properties:
        username:
          $ref: '#/components/schemas/Username'
        password:
          $ref: '#/components/schemas/Password'
    UserInfo:
      type: object
      required:
        - username
        - access
      properties:
        username:
          $ref: '#/components/schemas/Username'
        access:
          $ref: '#/components/schemas/AccessGroups'
    User:
      type: object
      required:
        - username
        - password
        - access
      properties:
        session_password:
          $ref: '#/components/schemas/Password'
        username:
          $ref: '#/components/schemas/Username'
        password:
          $ref: '#/components/schemas/Password'
        access:
          $ref: '#/components/schemas/AccessGroups'
    BearerToken:
      type: object
      properties:
        token:
          type: string
          pattern: '^[\w-=]+\.[\w-=]+\.[\w-=]+$'
    ControlTagSet:
      type: object
      properties:
        num:
          type: integer
        action:
          type: string
          enum: [activate_tag]
        tag_num:
          type: integer
    Scene:
      type: object
      properties:
        name:
          type: string
        num:
          type: integer
    Space:
      type: object
      properties:
        name:
          type: string
        num:
          type: integer
        intensity_master:
          type: integer
        active_scene:
          $ref: "#/components/schemas/Scene"
        is_modified:
          type: boolean
        child_spaces:
          type: array
          items:
            $ref: "#/components/schemas/Space"
        child_scenes:
          type: array
          items:
            $ref: "#/components/schemas/Scene"
    ControlSpace:
      type: object
      properties:
        num:
          type: integer
        action:
          type: string
          enum: [master_intensity]
        level:
          $ref: '#/components/schemas/LevelInBounded'
    RdmDeviceUid:
      type: string
      description: >
        Format must be {manuId}:{deviceId}(:{subId})
        where {manuId} is a padded unsigned hexadecimal integer of width 4, lowercase, e.g. 072c
        where {deviceId} is a padded unsigned hexadecimal integer of width 8, lowercase, e.g. 0004fe02
        where {subId} is an optional unsigned decimal integer.
      example: 1234:56789abc
    RdmDeviceInfo:
      type: object
      properties:
        uid:
          $ref: "#/components/schemas/RdmDeviceUid"
        rdm_protocol_version:
          type: integer
          minimum: 0
          maximum: 65535
        device_model_id:
          type: integer
          format: int32
          minimum: 0
          maximum: 65535
        product_category:
          type: integer
          format: int32
          minimum: 0
          maximum: 65535
        software_version_id:
          type: integer
          format: int32
        dmx512_footprint:
          type: integer
          format: int32
          minimum: 0
          maximum: 512
          exclusiveMaximum: true
        dmx512_personality:
          type: integer
          format: int32
          minimum: 0
          maximum: 65535
        dmx512_start_address:
          type: integer
          format: int32
          minimum: 1
          maximum: 512
        sub_device_count:
          type: integer
          format: int32
          minimum: 0
          maximum: 65535
        sensor_count:
          type: integer
          format: int32
          minimum: 0
          maximum: 255
    StartRdmDiscovery:
      type: object
      properties:
        universe:
          $ref: "#/components/schemas/UniverseId"
    StartRdmOperation:
      type: object
      properties:
        universe:
          $ref: "#/components/schemas/UniverseId"
        destination_uid:
          type: string
        pid:
          type: string
          enum: [
            COMMS_STATUS,
            STATUS_MESSAGES,
            SUPPORTED_PARAMETERS,
            PARAMETER_DESCRIPTION,
            DEVICE_INFO,
            DEVICE_MODEL_DESCRIPTION,
            MANUFACTURER_LABEL,
            DEVICE_LABEL,
            FACTORY_DEFAULTS,
            IDENTIFY_DEVICE,
            SOFTWARE_VERSION_LABEL,
            BOOT_SOFTWARE_VERSION_ID,
            BOOT_SOFTWARE_VERSION_LABEL,
            DMX_PERSONALITY,
            DMX_PERSONALITY_DESCRIPTION,
            DMX_START_ADDRESS,
            SLOT_INFO,
            SLOT_DESCRIPTION,
            SENSOR_DEFINITION,
            SENSOR_VALUE,
            CURVE,
            CURVE_DESCRIPTION
            ]
        meta:
          oneOf:
            - $ref: '#/components/schemas/RdmGetStatusMessages'
            - $ref: '#/components/schemas/RdmGetParameterDescription'
            - $ref: '#/components/schemas/RdmGetDmxPersonalityDescription'
            - $ref: '#/components/schemas/RdmGetSlotDescription'
            - $ref: '#/components/schemas/RdmGetSensorInfo'
            - $ref: '#/components/schemas/RdmSetDeviceLabel'
            - $ref: '#/components/schemas/RdmSetIdentifyDevice'
            - $ref: '#/components/schemas/RdmSetDmxStartAddress'
            - $ref: '#/components/schemas/RdmSetDmxPersonality'
            - $ref: '#/components/schemas/RdmSetSensorValue'
            - $ref: '#/components/schemas/RdmSetLampHours'
            - $ref: '#/components/schemas/RdmSetLampState'
            - $ref: '#/components/schemas/RdmSetRaw'
        max_rx_length:
          type: integer
    StartRdmGetDescriptionsOperation:
      type: object
      properties:
        universe:
          $ref: "#/components/schemas/UniverseId"
        destination_uid:
          type: string
        pid:
          type: string
          enum:
            - DMX_PERSONALITY
    AccessGroup:
      type: string
      description: Group to be assigned to a user
      enum:
        - status
        - control
        - admin
    AccessGroups:
      type: array
      items:
        $ref: '#/components/schemas/AccessGroup'
      uniqueItems: true
    Password:
      type: string
      example: verysecret123
    Username:
      type: string
      example: bob
    RdmGetStatusMessages:
      type: object
      properties:
        status_type:
          type: integer
    RdmGetParameterDescription:
      type: object
      properties:
        pid_requested:
          type: integer
    RdmGetDmxPersonalityDescription:
      type: object
      properties:
        personality_requested:
          type: integer
    RdmGetSlotDescription:
      type: object
      properties:
        slot_number_requested:
          type: integer
    RdmGetSensorInfo:
      type: object
      properties:
        sensor_number_requested:
          type: integer
    RdmSetDeviceLabel:
      type: object
      properties:
        label:
          type: string
    RdmSetIdentifyDevice:
      type: object
      properties:
        enable:
          type: boolean
    RdmSetDmxStartAddress:
      type: object
      properties:
        start_address:
          type: integer
    RdmSetDmxPersonality:
      type: object
      properties:
        personality:
          type: integer
    RdmSetSensorValue:
      type: object
      properties:
        sensor_number:
          type: integer
    RdmSetLampHours:
      type: object
      properties:
        lamp_hours:
          type: integer
    RdmSetLampState:
      type: object
      properties:
        lamp_state:
          type: integer
    RdmSetRaw:
      type: object
      properties:
        raw:
          type: string
    Override:
      type: object
      properties:
        intensity:
          oneOf:
            - $ref: '#/components/schemas/LevelIn'
            - $ref: '#/components/schemas/SnapshotOverride'
        colour:
          oneOf:
            - $ref: '#/components/schemas/ColourInRGB'
            - $ref: '#/components/schemas/ColourInHS'
            - $ref: '#/components/schemas/SnapshotOverride'
        temperature:
          oneOf:
            - $ref: '#/components/schemas/LevelIn'
            - $ref: '#/components/schemas/SnapshotOverride'
    ColourInRGB:
      type: object
      properties:
        red:
          $ref: '#/components/schemas/LevelIn'
        green:
          $ref: '#/components/schemas/LevelIn'
        blue:
          $ref: '#/components/schemas/LevelIn'
    ColourInHS:
      type: object
      required:
        - hue
        - saturation
      properties:
        hue:
          $ref: '#/components/schemas/LevelIn'
        saturation:
          $ref: '#/components/schemas/LevelIn'
    SnapshotOverride:
      type: string
      enum: [snapshot]
    ColourOutRGB:
      type: object
      properties:
        red:
          $ref: '#/components/schemas/LevelOut'
        green:
          $ref: '#/components/schemas/LevelOut'
        blue:
          $ref: '#/components/schemas/LevelOut'
    ColourOutHS:
      type: object
      required:
        - hue
        - saturation
      properties:
        hue:
          $ref: '#/components/schemas/LevelOut'
        saturation:
          $ref: '#/components/schemas/LevelOut'
    LevelIn:
      oneOf:
        - type: integer
          minimum: 0
          maximum: 255
        - type: string
          pattern: '^\d{1,3}(\.\d+)?%$'
    LevelInBounded:
      oneOf:
        - type: number
        - type: string
          pattern: '^\d+:\d+$'
          description: Bounded integer
    LevelOut:
      type: integer
      minimum: 0
      maximum: 65535
    Fade:
      type: object
      properties:
        fade:
          type: integer
          minimum: 0
          maximum: 3600000
        path:
          type: string
          enum:
            - default
            - linear
            - start
            - end
            - braked
            - accelerated
            - damped
            - overshoot
    TagSet:
      type: object
      properties:
        tags:
          type: array
          items:
            $ref: '#/components/schemas/Tag'
        num:
          type: integer
        name:
          type: string
        is_editable:
          type: boolean
        active_tag:
          type: integer
    Tag:
      type: object
      properties:
        num:
          type: integer
        name:
          type: string
    Token:
      type: string
      example: eyJhbGciOiJIUzI1NiJ9.eyJSb2xlIjoiQWRtaW4iLCJJc3N1ZXIiOiJQaGFyb3MiLCJVc2VybmFtZSI6ImJvYiIsImV4cCI6MTYxMjM0MjA4OCwiaWF0IjoxNjEyMzQyMDg4fQ.xRhBsEzpvEkH2AchnwrpifXsW7ZcffQSeAcFTRtqNJM
    Error:
      type: object
      properties:
        title:
          type: string
          example: Unauthorized
        detail:
          type: string
          example: Invalid credentials
        code:
          type: string
          example: 401
    Errors:
      type: object
      properties:
        errors:
          type: array
          items:
            $ref: '#/components/schemas/Error'
    Ping:
      type: object
      properties:
        target:
          type: ip address or hostname
        interface:
          type: integer
    FixtureDeviceStatus:
      type: string
      nullable: true
      enum:
        - online
        - partially_offline
        - offline
        - loading
        - null
    FixtureStatusOverview:
      type: object
      properties:
        groups:
          type: array
          items:
            type: string
          example:
            - "1 All Exterior"
        manufacturer:
          type: string
          example: Generic
        name:
          type: string
          example: Wall Uplights
        number:
          type: integer
          example: 1
        patch:
          type: string
          example: dmx:2:101
        protocol:
          type: string
          enum:
            - dali
            - dmx
          example: dmx
        status:
          $ref: '#/components/schemas/FixtureDeviceStatus'
        updated_at:
          type: string
          nullable: true
          format: date-time
    FixtureStatusDetail:
      allOf:
        - $ref: '#/components/schemas/FixtureStatusOverview'
        - type: object
          properties:
            type:
              type: string
              example: LED - RGBW 8 bit
            rdm_device_uids:
              type: array
              items:
                $ref: '#/components/schemas/RdmDeviceUid'
            custom_properties:
              type: object
              example:
                Custom Property 1: foo
                Custom Property 2: bar
    DeviceStatus:
      type: object
      properties:
        uid:
          $ref: '#/components/schemas/RdmDeviceUid'
        patch:
          type: string
          example: dmx:2:101
        rdm:
          type: object
        status:
          $ref: '#/components/schemas/FixtureDeviceStatus'
        updated_at:
          type: string
          nullable: true
          format: date-time